SML.di("./shell-e48e5956.js",import.meta.url,"shelle48e5956");SML.di("./icon-c33661e6.js",import.meta.url,"iconc33661e6");SML.di("./should-cont-truncate-d81ee171.js",import.meta.url,"shouldconttruncated81ee171");SML.di("./render-toast-5ba1c1f2.js",import.meta.url,"rendertoast5ba1c1f2");SML.di("./age-gate-standalone-client-js-b13e879d.js",import.meta.url,"agegatestandaloneclientjsb13e879d");SML.di("./TinyGesture-26737d23.js",import.meta.url,"TinyGesture26737d23");SML.di("./models-f287e395.js",import.meta.url,"modelsf287e395");SML.di("./feeds-869c579e.js",import.meta.url,"feeds869c579e");SML.di("./expandable-section-header-41e0cfd1.js",import.meta.url,"expandablesectionheader41e0cfd1");SML.di("./table-pagination-77cf692d.js",import.meta.url,"tablepagination77cf692d");SML.di("./select-controller-4c63b3e8.js",import.meta.url,"selectcontroller4c63b3e8");SML.di("./user-flair-fe275854.js",import.meta.url,"userflairfe275854");
SML.dm("redditchatclientjsdb12be0b",["shelle48e5956","iconc33661e6","shouldconttruncated81ee171","rendertoast5ba1c1f2","agegatestandaloneclientjsb13e879d","TinyGesture26737d23","modelsf287e395","feeds869c579e","expandablesectionheader41e0cfd1","selectcontroller4c63b3e8","tablepagination77cf692d","userflairfe275854"],(async(t,e,i,n,s,a,r,o,h,l)=>{var c=/[$_\p{ID_Start}]/u,u=/[$_\u200C\u200D\p{ID_Continue}]/u;function d(t,e){return/^[\x00-\x7F]*$/.test(t)}function p(t,e=!1){const i=[];let n=0;for(;n<t.length;){const s=t[n],a=function(s){if(!e)throw new TypeError(s);i.push({type:"INVALID_CHAR",index:n,value:t[n++]})};if("*"!==s)if("+"!==s&&"?"!==s)if("\\"!==s)if("{"!==s)if("}"!==s)if(":"!==s)if("("!==s)i.push({type:"CHAR",index:n,value:t[n++]});else{let e=1,s="",r=n+1,o=!1;if("?"===t[r]){a(`Pattern cannot start with "?" at ${r}`);continue}for(;r<t.length;){if(!d(t[r])){a(`Invalid character '${t[r]}' at ${r}.`),o=!0;break}if("\\"!==t[r]){if(")"===t[r]){if(e--,0===e){r++;break}}else if("("===t[r]&&(e++,"?"!==t[r+1])){a(`Capturing groups are not allowed at ${r}`),o=!0;break}s+=t[r++]}else s+=t[r++]+t[r++]}if(o)continue;if(e){a(`Unbalanced pattern at ${n}`);continue}if(!s){a(`Missing pattern at ${n}`);continue}i.push({type:"PATTERN",index:n,value:s}),n=r}else{let e="",s=n+1;for(;s<t.length;){const i=t.substr(s,1);if(!(s===n+1&&c.test(i)||s!==n+1&&u.test(i)))break;e+=t[s++]}if(!e){a(`Missing parameter name at ${n}`);continue}i.push({type:"NAME",index:n,value:e}),n=s}else i.push({type:"CLOSE",index:n,value:t[n++]});else i.push({type:"OPEN",index:n,value:t[n++]});else i.push({type:"ESCAPED_CHAR",index:n++,value:t[n++]});else i.push({type:"MODIFIER",index:n,value:t[n++]});else i.push({type:"ASTERISK",index:n,value:t[n++]})}return i.push({type:"END",index:n,value:""}),i}function m(t,e={}){const i=p(t),{prefixes:n="./"}=e,s=`[^${g(void 0===e.delimiter?"/#?":e.delimiter)}]+?`,a=[];let r=0,o=0,h="",l=new Set;const c=t=>{if(o<i.length&&i[o].type===t)return i[o++].value},u=()=>{const t=c("MODIFIER");return t||c("ASTERISK")},d=t=>{const e=c(t);if(void 0!==e)return e;const{type:n,index:s}=i[o];throw new TypeError(`Unexpected ${n} at ${s}, expected ${t}`)},m=()=>{let t,e="";for(;t=c("CHAR")||c("ESCAPED_CHAR");)e+=t;return e},f=e.encodePart||(t=>t);for(;o<i.length;){const t=c("CHAR"),e=c("NAME");let i=c("PATTERN");if(e||i||!c("ASTERISK")||(i=".*"),e||i){let o=t||"";-1===n.indexOf(o)&&(h+=o,o=""),h&&(a.push(f(h)),h="");const c=e||r++;if(l.has(c))throw new TypeError(`Duplicate name '${c}'.`);l.add(c),a.push({name:c,prefix:f(o),suffix:"",pattern:i||s,modifier:u()||""});continue}const o=t||c("ESCAPED_CHAR");if(o){h+=o;continue}if(c("OPEN")){const t=m(),e=c("NAME")||"";let i=c("PATTERN")||"";e||i||!c("ASTERISK")||(i=".*");const n=m();d("CLOSE");const o=u()||"";if(!e&&!i&&!o){h+=t;continue}if(!e&&!i&&!t)continue;h&&(a.push(f(h)),h=""),a.push({name:e||(i?r++:""),pattern:e&&!i?s:i,prefix:f(t),suffix:f(n),modifier:o})}else h&&(a.push(f(h)),h=""),d("END")}return a}function g(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function f(t){return t&&t.ignoreCase?"ui":"u"}function C(t,e,i={}){const{strict:n=!1,start:s=!0,end:a=!0,encode:r=t=>t}=i,o=`[${g(void 0===i.endsWith?"":i.endsWith)}]|$`,h=`[${g(void 0===i.delimiter?"/#?":i.delimiter)}]`;let l=s?"^":"";for(const i of t)if("string"==typeof i)l+=g(r(i));else{const t=g(r(i.prefix)),n=g(r(i.suffix));if(i.pattern)if(e&&e.push(i),t||n)if("+"===i.modifier||"*"===i.modifier){const e="*"===i.modifier?"?":"";l+=`(?:${t}((?:${i.pattern})(?:${n}${t}(?:${i.pattern}))*)${n})${e}`}else l+=`(?:${t}(${i.pattern})${n})${i.modifier}`;else"+"===i.modifier||"*"===i.modifier?l+=`((?:${i.pattern})${i.modifier})`:l+=`(${i.pattern})${i.modifier}`;else l+=`(?:${t}${n})${i.modifier}`}if(a)n||(l+=`${h}?`),l+=i.endsWith?`(?=${o})`:"$";else{const e=t[t.length-1],i="string"==typeof e?h.indexOf(e[e.length-1])>-1:void 0===e;n||(l+=`(?:${h}(?=${o}))?`),i||(l+=`(?=${h}|${o})`)}return new RegExp(l,f(i))}function b(t,e,i){return t instanceof RegExp?function(t){return t}(t):Array.isArray(t)?function(t,e,i){const n=t.map((t=>b(t,e,i).source));return new RegExp(`(?:${n.join("|")})`,f(i))}(t,e,i):function(t,e,i){return C(m(t,i),e,i)}(t,e,i)}var S={delimiter:"",prefixes:"",sensitive:!0,strict:!0},v={delimiter:".",prefixes:"",sensitive:!0,strict:!0},x={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function w(t,e){return t.startsWith(e)?t.substring(e.length,t.length):t}function y(t){return!(!t||t.length<2)&&("["===t[0]||("\\"===t[0]||"{"===t[0])&&"["===t[1])}var T=["ftp","file","http","https","ws","wss"];function E(t){if(!t)return!0;for(const e of T)if(t.test(e))return!0;return!1}function k(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}function R(t){if(""===t)return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}function I(t){if(""===t)return t;const e=new URL("https://example.com");return e.username=t,e.username}function L(t){if(""===t)return t;const e=new URL("https://example.com");return e.password=t,e.password}function P(t){if(""===t)return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);const e=new URL("https://example.com");return e.hostname=t,e.hostname}function A(t){if(""===t)return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}function $(t){if(""===t)return t;if(/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}function _(t){if(""===t)return t;const e=new URL("https://example.com");return e.pathname="/"!==t[0]?"/-"+t:t,"/"!==t[0]?e.pathname.substring(2,e.pathname.length):e.pathname}function U(t){if(""===t)return t;return new URL(`data:${t}`).pathname}function M(t){if(""===t)return t;const e=new URL("https://example.com");return e.search=t,e.search.substring(1,e.search.length)}function D(t){if(""===t)return t;const e=new URL("https://example.com");return e.hash=t,e.hash.substring(1,e.hash.length)}var O=class{constructor(t){this.tokenList=[],this.internalResult={},this.tokenIndex=0,this.tokenIncrement=1,this.componentStart=0,this.state=0,this.groupDepth=0,this.hostnameIPv6BracketDepth=0,this.shouldTreatAsStandardURL=!1,this.input=t}get result(){return this.internalResult}parse(){for(this.tokenList=p(this.input,!0);this.tokenIndex<this.tokenList.length;this.tokenIndex+=this.tokenIncrement){if(this.tokenIncrement=1,"END"===this.tokenList[this.tokenIndex].type){if(0===this.state){this.rewind(),this.isHashPrefix()?this.changeState(9,1):this.isSearchPrefix()?(this.changeState(8,1),this.internalResult.hash=""):(this.changeState(7,0),this.internalResult.search="",this.internalResult.hash="");continue}if(2===this.state){this.rewindAndSetState(5);continue}this.changeState(10,0);break}if(this.groupDepth>0){if(!this.isGroupClose())continue;this.groupDepth-=1}if(this.isGroupOpen())this.groupDepth+=1;else switch(this.state){case 0:this.isProtocolSuffix()&&(this.internalResult.username="",this.internalResult.password="",this.internalResult.hostname="",this.internalResult.port="",this.internalResult.pathname="",this.internalResult.search="",this.internalResult.hash="",this.rewindAndSetState(1));break;case 1:if(this.isProtocolSuffix()){this.computeShouldTreatAsStandardURL();let t=7,e=1;this.shouldTreatAsStandardURL&&(this.internalResult.pathname="/"),this.nextIsAuthoritySlashes()?(t=2,e=3):this.shouldTreatAsStandardURL&&(t=2),this.changeState(t,e)}break;case 2:this.isIdentityTerminator()?this.rewindAndSetState(3):(this.isPathnameStart()||this.isSearchPrefix()||this.isHashPrefix())&&this.rewindAndSetState(5);break;case 3:this.isPasswordPrefix()?this.changeState(4,1):this.isIdentityTerminator()&&this.changeState(5,1);break;case 4:this.isIdentityTerminator()&&this.changeState(5,1);break;case 5:this.isIPv6Open()?this.hostnameIPv6BracketDepth+=1:this.isIPv6Close()&&(this.hostnameIPv6BracketDepth-=1),this.isPortPrefix()&&!this.hostnameIPv6BracketDepth?this.changeState(6,1):this.isPathnameStart()?this.changeState(7,0):this.isSearchPrefix()?this.changeState(8,1):this.isHashPrefix()&&this.changeState(9,1);break;case 6:this.isPathnameStart()?this.changeState(7,0):this.isSearchPrefix()?this.changeState(8,1):this.isHashPrefix()&&this.changeState(9,1);break;case 7:this.isSearchPrefix()?this.changeState(8,1):this.isHashPrefix()&&this.changeState(9,1);break;case 8:this.isHashPrefix()&&this.changeState(9,1)}}}changeState(t,e){switch(this.state){case 0:case 2:break;case 1:this.internalResult.protocol=this.makeComponentString();break;case 3:this.internalResult.username=this.makeComponentString();break;case 4:this.internalResult.password=this.makeComponentString();break;case 5:this.internalResult.hostname=this.makeComponentString();break;case 6:this.internalResult.port=this.makeComponentString();break;case 7:this.internalResult.pathname=this.makeComponentString();break;case 8:this.internalResult.search=this.makeComponentString();break;case 9:this.internalResult.hash=this.makeComponentString()}this.changeStateWithoutSettingComponent(t,e)}changeStateWithoutSettingComponent(t,e){this.state=t,this.componentStart=this.tokenIndex+e,this.tokenIndex+=e,this.tokenIncrement=0}rewind(){this.tokenIndex=this.componentStart,this.tokenIncrement=0}rewindAndSetState(t){this.rewind(),this.state=t}safeToken(t){return t<0&&(t=this.tokenList.length-t),t<this.tokenList.length?this.tokenList[t]:this.tokenList[this.tokenList.length-1]}isNonSpecialPatternChar(t,e){const i=this.safeToken(t);return i.value===e&&("CHAR"===i.type||"ESCAPED_CHAR"===i.type||"INVALID_CHAR"===i.type)}isProtocolSuffix(){return this.isNonSpecialPatternChar(this.tokenIndex,":")}nextIsAuthoritySlashes(){return this.isNonSpecialPatternChar(this.tokenIndex+1,"/")&&this.isNonSpecialPatternChar(this.tokenIndex+2,"/")}isIdentityTerminator(){return this.isNonSpecialPatternChar(this.tokenIndex,"@")}isPasswordPrefix(){return this.isNonSpecialPatternChar(this.tokenIndex,":")}isPortPrefix(){return this.isNonSpecialPatternChar(this.tokenIndex,":")}isPathnameStart(){return this.isNonSpecialPatternChar(this.tokenIndex,"/")}isSearchPrefix(){if(this.isNonSpecialPatternChar(this.tokenIndex,"?"))return!0;if("?"!==this.tokenList[this.tokenIndex].value)return!1;const t=this.safeToken(this.tokenIndex-1);return"NAME"!==t.type&&"PATTERN"!==t.type&&"CLOSE"!==t.type&&"ASTERISK"!==t.type}isHashPrefix(){return this.isNonSpecialPatternChar(this.tokenIndex,"#")}isGroupOpen(){return"OPEN"==this.tokenList[this.tokenIndex].type}isGroupClose(){return"CLOSE"==this.tokenList[this.tokenIndex].type}isIPv6Open(){return this.isNonSpecialPatternChar(this.tokenIndex,"[")}isIPv6Close(){return this.isNonSpecialPatternChar(this.tokenIndex,"]")}makeComponentString(){const t=this.tokenList[this.tokenIndex],e=this.safeToken(this.componentStart).index;return this.input.substring(e,t.index)}computeShouldTreatAsStandardURL(){const t={};Object.assign(t,S),t.encodePart=R;const e=b(this.makeComponentString(),void 0,t);this.shouldTreatAsStandardURL=E(e)}},N=["protocol","username","password","hostname","port","pathname","search","hash"],z="*";function H(t,e){if("string"!=typeof t)throw new TypeError("parameter 1 is not of type 'string'.");const i=new URL(t,e);return{protocol:i.protocol.substring(0,i.protocol.length-1),username:i.username,password:i.password,hostname:i.hostname,port:i.port,pathname:i.pathname,search:""!=i.search?i.search.substring(1,i.search.length):void 0,hash:""!=i.hash?i.hash.substring(1,i.hash.length):void 0}}function j(t,e){return e?W(t):t}function q(t,e,i){let n;if("string"==typeof e.baseURL)try{n=new URL(e.baseURL),t.protocol=j(n.protocol.substring(0,n.protocol.length-1),i),t.username=j(n.username,i),t.password=j(n.password,i),t.hostname=j(n.hostname,i),t.port=j(n.port,i),t.pathname=j(n.pathname,i),t.search=j(n.search.substring(1,n.search.length),i),t.hash=j(n.hash.substring(1,n.hash.length),i)}catch{throw new TypeError(`invalid baseURL '${e.baseURL}'.`)}if("string"==typeof e.protocol&&(t.protocol=function(t,e){var i,n;return n=":",t=(i=t).endsWith(n)?i.substr(0,i.length-n.length):i,e||""===t?t:R(t)}(e.protocol,i)),"string"==typeof e.username&&(t.username=function(t,e){if(e||""===t)return t;const i=new URL("https://example.com");return i.username=t,i.username}(e.username,i)),"string"==typeof e.password&&(t.password=function(t,e){if(e||""===t)return t;const i=new URL("https://example.com");return i.password=t,i.password}(e.password,i)),"string"==typeof e.hostname&&(t.hostname=function(t,e){return e||""===t?t:y(t)?A(t):P(t)}(e.hostname,i)),"string"==typeof e.port&&(t.port=function(t,e,i){return k(e)===t&&(t=""),i||""===t?t:$(t)}(e.port,t.protocol,i)),"string"==typeof e.pathname){if(t.pathname=e.pathname,n&&!function(t,e){return!(!t.length||"/"!==t[0]&&(!e||t.length<2||"\\"!=t[0]&&"{"!=t[0]||"/"!=t[1]))}(t.pathname,i)){const e=n.pathname.lastIndexOf("/");e>=0&&(t.pathname=j(n.pathname.substring(0,e+1),i)+t.pathname)}t.pathname=function(t,e,i){if(i||""===t)return t;if(e&&!T.includes(e))return new URL(`${e}:${t}`).pathname;const n="/"==t[0];return t=new URL(n?t:"/-"+t,"https://example.com").pathname,n||(t=t.substring(2,t.length)),t}(t.pathname,t.protocol,i)}return"string"==typeof e.search&&(t.search=function(t,e){if(t=w(t,"?"),e||""===t)return t;const i=new URL("https://example.com");return i.search=t,i.search?i.search.substring(1,i.search.length):""}(e.search,i)),"string"==typeof e.hash&&(t.hash=function(t,e){if(t=w(t,"#"),e||""===t)return t;const i=new URL("https://example.com");return i.hash=t,i.hash?i.hash.substring(1,i.hash.length):""}(e.hash,i)),t}function W(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}function B(t,e){const i=`[^${n=void 0===e.delimiter?"/#?":e.delimiter,n.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}]+?`;var n;const s=/[$_\u200C\u200D\p{ID_Continue}]/u;let a="";for(let n=0;n<t.length;++n){const r=t[n],o=n>0?t[n-1]:null,h=n<t.length-1?t[n+1]:null;if("string"==typeof r){a+=W(r);continue}if(""===r.pattern){if(""===r.modifier){a+=W(r.prefix);continue}a+=`{${W(r.prefix)}}${r.modifier}`;continue}const l="number"!=typeof r.name,c=void 0!==e.prefixes?e.prefixes:"./";let u=""!==r.suffix||""!==r.prefix&&(1!==r.prefix.length||!c.includes(r.prefix));if(!u&&l&&r.pattern===i&&""===r.modifier&&h&&!h.prefix&&!h.suffix)if("string"==typeof h){const t=h.length>0?h[0]:"";u=s.test(t)}else u="number"==typeof h.name;if(!u&&""===r.prefix&&o&&"string"==typeof o&&o.length>0){const t=o[o.length-1];u=c.includes(t)}u&&(a+="{"),a+=W(r.prefix),l&&(a+=`:${r.name}`),".*"===r.pattern?l||o&&"string"!=typeof o&&!o.modifier&&!u&&""===r.prefix?a+="(.*)":a+="*":r.pattern===i?l||(a+=`(${i})`):a+=`(${r.pattern})`,r.pattern===i&&l&&""!==r.suffix&&s.test(r.suffix[0])&&(a+="\\"),a+=W(r.suffix),u&&(a+="}"),a+=r.modifier}return a}globalThis.URLPattern||(globalThis.URLPattern=class{constructor(t={},e,i){this.regexp={},this.keys={},this.component_pattern={};try{let n;if("string"==typeof e?n=e:i=e,"string"==typeof t){const e=new O(t);if(e.parse(),t=e.result,void 0===n&&"string"!=typeof t.protocol)throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=n}else{if(!t||"object"!=typeof t)throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(n)throw new TypeError("parameter 1 is not of type 'string'.")}void 0===i&&(i={ignoreCase:!1});const s={ignoreCase:!0===i.ignoreCase},a={pathname:z,protocol:z,username:z,password:z,hostname:z,port:z,search:z,hash:z};let r;for(r of(this.pattern=q(a,t,!0),k(this.pattern.protocol)===this.pattern.port&&(this.pattern.port=""),N)){if(!(r in this.pattern))continue;const t={},e=this.pattern[r];switch(this.keys[r]=[],r){case"protocol":Object.assign(t,S),t.encodePart=R;break;case"username":Object.assign(t,S),t.encodePart=I;break;case"password":Object.assign(t,S),t.encodePart=L;break;case"hostname":Object.assign(t,v),y(e)?t.encodePart=A:t.encodePart=P;break;case"port":Object.assign(t,S),t.encodePart=$;break;case"pathname":E(this.regexp.protocol)?(Object.assign(t,x,s),t.encodePart=_):(Object.assign(t,S,s),t.encodePart=U);break;case"search":Object.assign(t,S,s),t.encodePart=M;break;case"hash":Object.assign(t,S,s),t.encodePart=D}try{const i=m(e,t);this.regexp[r]=C(i,this.keys[r],t),this.component_pattern[r]=B(i,t)}catch{throw new TypeError(`invalid ${r} pattern '${this.pattern[r]}'.`)}}}catch(t){throw new TypeError(`Failed to construct 'URLPattern': ${t.message}`)}}test(t={},e){let i,n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if("string"!=typeof t&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(void 0===t)return!1;try{n=q(n,"object"==typeof t?t:H(t,e),!1)}catch(t){return!1}for(i of N)if(!this.regexp[i].exec(n[i]))return!1;return!0}exec(t={},e){let i={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if("string"!=typeof t&&e)throw new TypeError("parameter 1 is not of type 'string'.");if(void 0===t)return;try{i=q(i,"object"==typeof t?t:H(t,e),!1)}catch(t){return null}let n,s={};for(n of(s.inputs=e?[t,e]:[t],N)){let t=this.regexp[n].exec(i[n]);if(!t)return null;let e={};for(let[i,s]of this.keys[n].entries())if("string"==typeof s.name||"number"==typeof s.name){let n=t[i+1];e[s.name]=n}s[n]={input:i[n]||"",groups:e}}return s}get protocol(){return this.component_pattern.protocol}get username(){return this.component_pattern.username}get password(){return this.component_pattern.password}get hostname(){return this.component_pattern.hostname}get port(){return this.component_pattern.port}get pathname(){return this.component_pattern.pathname}get search(){return this.component_pattern.search}get hash(){return this.component_pattern.hash}});const F=async(...e)=>{const i=await t.B(...e);return i.errors&&0===i.errors.length&&(i.errors=void 0),i};class Q{constructor(){this.queryChannelRecommendations=(e,i)=>F({operation:t.O.AllChatsPageRecommendations,variables:e,init:{signal:i?.abortController?.signal}}),this.queryContentControlSettings=(e,i)=>F({operation:t.O.ChatContentControlSettings,variables:e,init:{signal:i?.abortController?.signal}}),this.queryCurrentUserContext=(e,i)=>F({operation:t.O.ChatCurrentUserContext,variables:e,init:{signal:i?.abortController?.signal}}),this.queryRedditors=(e,i)=>F({operation:t.O.ChatRedditors,variables:e,init:{signal:i?.abortController?.signal}}),this.queryRedditorsByName=(e,i)=>F({operation:t.O.ChatRedditorsByName,variables:e,init:{signal:i?.abortController?.signal}}),this.queryBannedUsers=e=>F({operation:t.O.ChatBannedUsers,variables:e}),this.searchChatMessageReactionIcons=(e,i)=>F({operation:t.O.ChatSearchChatMessageReactionIcons,variables:e,init:{signal:i?.abortController?.signal}}),this.getShareUrl=(e,i)=>F({operation:t.O.ChatShareUrl,variables:e,init:{signal:i?.abortController?.signal}}),this.queryCrowdControlSettings=(e,i)=>F({operation:t.O.ChatCrowdControlSettings,variables:e,init:{signal:i?.abortController?.signal}}),this.getUccChannelTaggingInfo=(e,i)=>F({operation:t.O.ChatGetUccChannelTaggingInfo,variables:e,init:{signal:i?.abortController?.signal}}),this.queryTagSubreddits=(e,i)=>F({operation:t.O.ChatQueryTagSubreddits,variables:e,init:{signal:i?.abortController?.signal}}),this.getChatChannelBannedUsers=(e,i)=>F({operation:t.O.ChatGetChatChannelBannedUsers,variables:e,init:{signal:i?.abortController?.signal}}),this.querySubreddit=(e,i)=>F({operation:t.O.ChatSubreddit,variables:e,init:{signal:i?.abortController?.signal}}),this.queryBlockedRedditors=(e,i)=>F({operation:t.O.ChatBlockedRedditors,variables:e,init:{signal:i?.abortController?.signal}}),this.queryReportForm=(e,i)=>F({operation:t.O.ChatReportForm,variables:e,init:{signal:i?.abortController?.signal}}),this.queryIsUserBannedFromChatChannel=(e,i)=>F({operation:t.O.ChatIsUserBannedFromChatChannel,variables:e,init:{signal:i?.abortController?.signal}}),this.banChatChannelUser=(e,i)=>F({operation:t.O.ChatBanChatChannelUser,variables:e,init:{signal:i?.abortController?.signal}}),this.createUccChatChannel=(e,i)=>F({operation:t.O.ChatCreateUccChatChannel,variables:e,init:{signal:i?.abortController?.signal}}),this.updateChannel=(e,i)=>F({operation:t.O.ChatUpdateChannel,variables:e,init:{signal:i?.abortController?.signal}}),this.updateChannelModerationSettings=(e,i)=>F({operation:t.O.ChatUpdateChannelModerationSettings,variables:e,init:{signal:i?.abortController?.signal}}),this.banSubredditUser=(e,i)=>F({operation:t.O.ChatBanSubredditUser,variables:e,init:{signal:i?.abortController?.signal}}),this.unbanSubredditUser=(e,i)=>F({operation:t.O.ChatUnbanSubredditUser,variables:e,init:{signal:i?.abortController?.signal}}),this.updateCrowdControlLevel=(e,i)=>F({operation:t.O.ChatUpdateCrowdControlLevel,variables:e,init:{signal:i?.abortController?.signal}}),this.pinMessagesToSubredditChannel=(e,i)=>F({operation:t.O.ChatPinMessagesToSubredditChannel,variables:e,init:{signal:i?.abortController?.signal}}),this.updateChatChannelUsersRoles=(e,i)=>F({operation:t.O.ChatUpdateChatChannelUsersRoles,variables:e,init:{signal:i?.abortController?.signal}}),this.retractChatChannelUserRoleInvitation=(e,i)=>F({operation:t.O.ChatRetractChatChannelUserRoleInvitation,variables:e,init:{signal:i?.abortController?.signal}}),this.updateChatChannelUserRolePromotion=(e,i)=>F({operation:t.O.ChatUpdateChatChannelUserRolePromotion,variables:e,init:{signal:i?.abortController?.signal}}),this.unbanChatChannelUser=(e,i)=>F({operation:t.O.ChatUnbanChatChannelUser,variables:e,init:{signal:i?.abortController?.signal}}),this.createShareUrl=(e,i)=>F({operation:t.O.ChatCreateShareUrl,variables:e,init:{signal:i?.abortController?.signal}}),this.createSubredditChannel=(e,i)=>F({operation:t.O.ChatCreateSubredditChannel,variables:e,init:{signal:i?.abortController?.signal}}),this.updateAccountPreferences=(e,i)=>F({operation:t.O.ChatUpdateAccountPreferences,variables:e,init:{signal:i?.abortController?.signal}}),this.updateRedditorBlockState=(e,i)=>F({operation:t.O.ChatUpdateRedditorBlockState,variables:e,init:{signal:i?.abortController?.signal}}),this.deleteChannel=(e,i)=>F({operation:t.O.ChatDeleteChannel,variables:e,init:{signal:i?.abortController?.signal}}),this.approveMod=(e,i)=>F({operation:t.O.ChatModApprove,variables:e,init:{signal:i?.abortController?.signal}}),this.removeMod=(e,i)=>F({operation:t.O.ChatModRemove,variables:e,init:{signal:i?.abortController?.signal}}),this.markAllAsRead=(e,i)=>F({operation:t.O.UpdateChatMessagesAsRead,variables:{...e,input:{channels:[]}},init:{signal:i?.abortController?.signal}})}}let G=class extends e.s{connectedCallback(){super.connectedCallback(),this.client??(this.client=new Q),window.customElements.whenDefined("rs-app").then((()=>{if(!this.client)return;const t=this.getRootNode();t.querySelector("rs-app")?.setGqlClientContext(this.client)}))}};G=t._([t.e("reddit-chat-gql-client")],G);let K=class extends e.s{constructor(){super(...arguments),this.ariaLive="polite",this.min=t.x.error,this.max=t.x.success,this._gesture=new a.T(this,{mouseSupport:!0}),this._alertsCtrl=new s.aq(this,{batchWindow:100,onAlert:i=>{const s={...i,meta:{...i.meta},namedContent:{...i.namedContent}},{level:a,namedContent:r}=s;r.action??(r.action=t.r({attributes:{onclick:()=>o.dismiss()},appearance:"plainInverted",leadingIcon:e.C()})),a===t.x.error&&(r.icon=e.aR({size:e.I.Large})),a===t.x.warning&&(r.icon=e.z({size:e.I.Large}));const o=n.r(this,s);a&&a>=t.x.warning&&a<=t.x.success&&window.setTimeout((()=>{o.dismiss()}),s.meta?.duration??4e3),this.appendChild(o)},isOnline:()=>!0})}static get styles(){return e.a`:host{position:fixed}:host>slot{display:flex;flex-direction:column;gap:var(--spacer-md);align-items:center;position:fixed;left:50%;transform:translateX(-50%);padding:0 1rem;bottom:var(--rem16)}`}connectedCallback(){super.connectedCallback(),this._alertsCtrl.options.min=this.min,this._alertsCtrl.options.max=this.max,this._gesture.on("swipeleft",this._onSwipe),this._gesture.on("swiperight",this._onSwipe)}disconnectedCallback(){super.disconnectedCallback(),this._gesture.destroy()}_onSwipe(t){if(t instanceof MouseEvent)return;const e=t.target instanceof HTMLElement?t.target:null,i=e?.closest("faceplate-toast");i instanceof n.F&&i.dismiss()}render(){return e.x`<slot></slot>`}};t._([t.n({type:String,reflect:!0,attribute:"aria-live"})],K.prototype,"ariaLive",void 0),t._([t.n({attribute:"min",converter:t.cp})],K.prototype,"min",void 0),t._([t.n({attribute:"max",converter:t.cp})],K.prototype,"max",void 0),K=t._([t.e("faceplate-toaster")],K);let V=class extends K{static get styles(){return e.a``}};V=t._([t.e("reddit-chat-toaster")],V);let Y=class extends l.F{constructor(){super();const t=this.show;this.show=e=>{t(e),this._menu.style.transform="translate(13px, -10px)"}}};var Z;Y=t._([t.e("chat-toast-menu")],Y),function(t){t.direct="direct",t.community="community",t.private_group="private_group",t.public_group="public_group",t.reddit_ucc="reddit_ucc"}(Z||(Z={}));const X=t=>t.stopPropagation(),J=({channelIconUrl:i,userAvatarUrl:n,roomType:s})=>{const a=s===Z.reddit_ucc||s===Z.community,r=n?e.x`<div class="${t.U({"bg-secondary-background rounded-full flex items-center justify-center overflow-hidden":!0,"mr-sm w-[40px] h-[40px] min-w-[40px] self-center":!a,"absolute right-0 bottom-0 w-lg h-lg":a})}"> <img class="${t.U({"w-[40px] h-[40px]":!a,"w-[20px] h-[20px]":a})}" src="${n}" alt="chat toast user avatar"> </div>`:e.A;return a?e.x`<div class="relative basis-[fit-content] mr-sm w-[40px] h-[40px] min-w-[40px] max-w-[40px] self-center"> ${i?e.x`<img class="w-100 h-100 rounded-full" src="${i}" alt="chat toast channel icon">`:(o=s,o===Z.reddit_ucc?e.x`<div class="flex items-center justify-center w-[40px] h-[40px] rounded-full bg-secondary-background"> ${e.cn({attributes:{className:"flex items-center justify-center bg-transparent fill-primary-background","aria-hidden":"true"}})} </div>`:e.V({attributes:{className:"flex justify-center items-center rounded-full w-full h-full bg-white text-global-alienblue box-border border-solid border-white border-[0.1rem]","aria-hidden":"true"}}))} ${r} </div>`:r;var o},tt=({notification:i,onClick:n,onClickNotificationSettings:s,onPauseNotifications:a,onRenderToast:r,onOpenToastMenu:o,onCloseToastMenu:l})=>{const{senderId:c,senderName:u,roomId:d,roomName:p,eventId:m,message:g,pauseNotifications:f}=i||{};if(!d||!m)return e.A;r();const C=e.x`<span class="font-bold">${u||c}</span>`,b=e.x`<span class="font-bold">${p}</span>`,S=p?e.x`${C} in ${b}`:C;return e.x` <div class="toast absolute w-[351px] bottom-0 right-0 bg-neutral-background p-sm flex rounded-2 mt-md text-tone-1 cursor-pointer shadow-sm hover:bg-neutral-background-hover" @click="${n}" @keydown="${n}" data-testid="chat-toast"> ${J(i)} <div class="flex flex-col"> <span class="line-clamp-1" data-testid="chat-toast-title">${S}</span> <span class="line-clamp-2" data-testid="chat-toast-message">${g}</span> </div> <div class="ml-auto" @click="${X}" @keydown="${X}"> ${(i=>{const{handlePauseNotifications:n,onClickNotificationSettings:s,onOpenToastMenu:a,onCloseToastMenu:r}=i;return e.x`<chat-toast-menu position="top" .onopen="${a}" .onclose="${r}"> ${t.r({appearance:"plain",size:t.s.ExtraSmall,attributes:{className:"overflow-visible !px-0 w-lg h-lg"},screenReaderContent:"Chat notifications toast options menu",children:e.ai({size:e.I.ExtraSmall})})} <faceplate-menu slot="menu" class="w-[220px]"> ${h.l({label:e.x`<span class="text-tone-1"> Pause for 1 hour </span>`,onClick:()=>n(1)})} ${h.l({label:e.x`<span class="text-tone-1"> Pause for 6 hours </span>`,onClick:()=>n(6)})} ${h.l({label:e.x`<span class="text-tone-1"> Pause for 24 hours </span>`,onClick:()=>n(24)})} ${h.l({label:e.x`<span class="text-tone-1"> Notification settings </span>`,onClick:s})} </faceplate-menu> </chat-toast-menu>`})({handlePauseNotifications:t=>{a(d),f(t)},onClickNotificationSettings:s,onOpenToastMenu:o,onCloseToastMenu:l})} </div> </div> `};var et;class it{constructor(t,e){et.set(this,!1),this.remaining=e,this.callback=t,this.timerId=void 0,this.start=void 0,this.resume()}get isPaused(){return t.gc(this,et,"f")}pause(){this.timerId&&this.start&&(this.clear(),this.remaining=this.remaining-(Date.now()-this.start),t.gd(this,et,!0))}resume(){this.timerId||(this.start=Date.now(),this.timerId=window.setTimeout(this.callback,this.remaining),t.gd(this,et,!1))}clear(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=void 0)}}et=new WeakMap;const nt=t=>"/"===t[t.length-1]?t:`${t}/`;var st;const at="minimized",rt=632,ot=506;function ht({width:t,height:e}){return e===ot&&t===rt?"standard":e>t?e<=ot?"portrait-sm":e>=768?"portrait-xl":"portrait-lg":t<=rt?"landscape-sm":t>=1024?"landscape-xl":"landscape-lg"}let lt=st=class extends(t.ge(t.g(e.s))){constructor(){super(...arguments),this.country="",this.isMultitaskingEnabled=!1,this.preload=!1,this.denyList=[],this.resizable=!1,this.uiState="closed",this.notificationCount=0,this.currentToast=null,this._locationImpl=window.location,this.toastsQueue=[],this.toastAutoDismissTimer=void 0,this.pushToastsFromQueueInterval=void 0,this.isEventListenersSet=!1,this.updateUIState=e=>{if(!this.isMultitaskingEnabled)return;const i=((t,e)=>{if(0===e.length)return!1;const i=nt(t);return e.some((t=>0===i.indexOf(nt(t))))})(e,this.denyList);if(this.inDeniedPath!==i)if(this.inDeniedPath=i,this.inDeniedPath)this.setUIState("closed");else{const e=t.v.get(t.gf)??at,i="closed"===e?at:e;this.setUIState(i)}},this.initialized=!1,this.handleNavigate=t=>{const e=new URL(t.destination.url);this.updateUIState(e.pathname)},this.setChatWidgetDimensionCookie=t.aB(((e,i)=>{const n=`${Math.floor(e.width)}:${Math.floor(e.height)}`;t.$({country:this.country,name:t.gh,value:n}),this.trackEvent(t.b({source:r.b.Chat,action:r.c.Resize,noun:r.d.Screen},{action_info:{type:i,setting_value:ht(e)}}))}),1e3,{leading:!0,trailing:!0}),this.hasChatClientActivated=!1,this.onChatClientClose=()=>{this.setUIState("closed")},this.onChatClientMaximize=()=>{this.setUIState("maximized"),this.dismissToast(),this.clearToastsFromQueue(),this.triggerChatTimelineScroll()},this.triggerChatTimelineScroll=()=>{const t=this.getShadowRoot().querySelector("rs-app");t?.shadowRoot?.querySelector("rs-room")?.shadowRoot?.querySelector("rs-timeline")?.shadowRoot?.querySelector("rs-virtual-scroll-dynamic")?.dispatchEvent(new CustomEvent("scroll"))},this.clearToastsFromQueue=t=>{this.toastsQueue=t?this.toastsQueue.filter((e=>e.roomId!==t)):[]},this.onChatClientMinimize=()=>{this.setUIState("minimized")},this.removeChatAppEventListeners=null,this.onChatOpenImageModal=e=>{if(!this.canUseLightbox())return;e.preventDefault();const{url:i}=e.detail,n=document.createElement("div"),s=document.createElement("div"),a=document.createElement("img");a.src=i,a.setAttribute("role","presentation"),a.setAttribute("fetchPriority","auto"),a.setAttribute("loading","lazy");const r=document.createElement("img");r.src=i,r.alt="Chat image",r.setAttribute("fetchPriority","auto"),r.setAttribute("loading","lazy"),s.className="h-full w-full object-contain overflow-hidden relative bg-black",a.className="absolute top-1/2 -translate-y-1/2 left-0 w-full opacity-30 object-cover scale-[1.2] post-background-image-filter",r.className="h-full w-full object-contain relative",s.appendChild(a),s.appendChild(r),n.appendChild(s);const o=new URL(location.href);o.hash="chat-image";const h=o.href.replace(o.origin,"");t.p(t.T.LightboxOpen,{element:n,attributes:{permalink:h}})},this.onChatAppStateChange=t=>{switch(t.detail){case"minimize":this.onChatClientMinimize();break;case"maximize":this.onChatClientMaximize();break;case"close":this.onChatClientClose()}},this.onChatNotificationsCountChange=t=>{this.notificationCount=t.detail,this.getShadowRoot().querySelector("dynamic-badge")?.setCount(this.notificationCount),this.updateNotificationCountInTheHeader(this.notificationCount)},this.onChatMultitaskingNotification=e=>{"maximized"!==this.uiState&&t.X()!==t.w.PostCreation&&this.toastsQueue.push(e.detail)},this.pushToastsFromQueue=()=>{if(this.toastAutoDismissTimer?.isPaused)return;const t=this.toastsQueue.shift();if(!t)return;const e=t.eventId;this.resetToastAutoDismissTimer(),this.currentToast=t,this.autoDismissToast(e)},this.onChatLocationChange=t=>{const e=t.detail,i=new URL(e.location.href);let n=i.href.replace(i.origin,"");n.startsWith("/")||(n="/"+n),this.setLatestPathCookie(n),this.updateChatClientTemplate(n)},this.onChatSccCreated=t=>{const e=t.detail.subredditName;if(!e)return;if(this._locationImpl.pathname===`/mod/${e}/chat-channels/channels`)return void this._locationImpl.reload();this._locationImpl.pathname===`/r/${e}/`&&document.querySelector(`faceplate-partial#${o.a}`)?.load()},this.onChatToastClick=()=>{if(!this.currentToast)return;const{eventId:e,roomId:i,chatTelemetry:n}=this.currentToast;this.trackEvent(t.b({source:r.C.Chat,action:t.aA.Click,noun:r.a.InAppToast},{chat:n})),this.dismissToast(),this.clearToastsFromQueue(),this.openChatUrl(`/room/${i}/event/${e}`)},this.onClickNotificationSettings=()=>{const t=this.currentToast?.roomId;t&&(this.openChatUrl(`/room/${t}/settings/manage-notifications`),this.dismissToast(),this.clearToastsFromQueue())},this.onPauseNotifications=t=>{this.dismissToast(),this.clearToastsFromQueue(t)},this.onRenderToast=()=>{if(!this.currentToast)return;const{chatTelemetry:e}=this.currentToast;this.trackEvent(t.b({source:r.C.Chat,action:t.aA.View,noun:r.a.InAppToast},{chat:e}))},this.onOpenToastMenu=()=>{if(!this.currentToast)return;const{chatTelemetry:e}=this.currentToast;this.toastAutoDismissTimer?.pause(),this.trackEvent(t.b({source:r.C.Chat,action:t.aA.View,noun:r.a.InAppToastActionSheet},{chat:e}))},this.onCloseToastMenu=()=>{this.toastAutoDismissTimer?.resume()},this.renderedTemplate=null,this.updateHeight=t=>{const e=Math.max(ot,t);this.getShadowRoot().getElementById("resizable").style.height=`${e}px`,this.dimensions.height=e},this.updateWidth=t=>{const e=Math.max(rt,t);this.getShadowRoot().getElementById("resizable").style.width=`${e}px`,this.dimensions.width=e},this.anchorPosition={x:window.innerWidth-rt,y:window.innerHeight},this.dimensions={width:rt,height:ot},this.onPointerDownDiagonal=()=>{const{bottom:t,right:e}=this.getShadowRoot().getElementById("resizable").getBoundingClientRect();this.anchorPosition={x:e,y:t},this.listenPointerEvents()},this.onResizeHandleKeyDown=t=>{if(st.RESIZE_HANDLE_KEYDOWN_KEYS.has(t.key)){if(t.preventDefault(),"r"===t.key)this.updateWidth(rt),this.updateHeight(ot);else{const e=t.shiftKey?16:4;"ArrowDown"===t.key&&this.updateHeight(this.dimensions.height-e),"ArrowUp"===t.key&&this.updateHeight(this.dimensions.height+e),"ArrowRight"===t.key&&this.updateWidth(this.dimensions.width-e),"ArrowLeft"===t.key&&this.updateWidth(this.dimensions.width+e)}this.setChatWidgetDimensionCookie(this.dimensions,"keyboard")}},this.listenPointerEvents=()=>{window.addEventListener("pointerup",this.onPointerUp,{once:!0}),window.addEventListener("pointermove",this.onPointerMove)},this.onPointerUp=()=>{window.removeEventListener("pointermove",this.onPointerMove)},this.onPointerMove=t=>{const{clientX:e,clientY:i}=t,n=this.anchorPosition.x-e,s=this.anchorPosition.y-i;this.updateWidth(n),this.updateHeight(s),this.setChatWidgetDimensionCookie(this.dimensions,"pointer")}}_setFocusManager(t){this._focusManager=t}_getFocusManager(){return this._focusManager}_setLocationImpl(t){this._locationImpl=t}init(){if(this.initialized)return;this.initialized=!0;const t=this.getChatWidgetDimensionCookie();this.resizable&&t&&(this.dimensions=t),this.updateUIState(window.location.pathname)}getShadowRoot(){return this.portalShadowRoot}connectedCallback(){super.connectedCallback(),this.setChatAppEventListeners(),this.pushToastsFromQueueInterval=setInterval((()=>{this.pushToastsFromQueue()}),2e3),window.navigation?.addEventListener("navigate",this.handleNavigate),this.init()}disconnectedCallback(){super.disconnectedCallback(),this.removeChatAppEventListeners?.(),clearInterval(this.pushToastsFromQueueInterval),this.pushToastsFromQueueInterval=void 0,window.navigation?.removeEventListener("navigate",this.handleNavigate)}setUIStateCookie(){t.$({country:this.country,name:t.gf,value:this.uiState})}setLatestPathCookie(e){t.$({country:this.country,name:t.gg,value:e??"/"})}getChatWidgetDimensionCookie(){const e=t.v.get(t.gh);if(!e)return null;const[i,n]=e.split(":").map(Number);return isNaN(i)||isNaN(n)?null:{width:i,height:n}}willUpdate(t){super.willUpdate(t);const e=t.has("uiState"),i=t.get("uiState");if(e&&void 0!==i){const t=this.getShadowRoot().querySelector("rs-app");"maximized"===this.uiState?t?.removeAttribute("background"):t?.setAttribute("background","true")}}handleUIStateChangeWhenPreloading(){this.hasChatClientActivated||(this.attachPortal(),this.setChatAppEventListeners(),this.hasChatClientActivated=!0)}handleUIStateChange(t){if(t&&"closed"!==t||"minimized"!==this.uiState&&"maximized"!==this.uiState){if(("minimized"===t||"maximized"===t)&&"closed"===this.uiState){const t=this.getShadowRoot().querySelector("rs-matrix-client");t?.pauseSync({blockRestart:!0,force:!0}),this.removeChatAppEventListeners?.(),this.removePortal()}}else{this.attachPortal();const t=this.getShadowRoot().querySelector("rs-matrix-client");this.hasChatClientActivated&&t?.startSync({unblockRestart:!0}),this.setChatAppEventListeners()}this.hasChatClientActivated||(this.hasChatClientActivated="closed"!==this.uiState)}updated(t){const e=t.get("uiState");e!==this.uiState&&(this.setUIStateCookie(),this.isMultitaskingEnabled||this.preload?this.handleUIStateChangeWhenPreloading():this.handleUIStateChange(e))}openChatUrl(t){if("closed"!==this.uiState||this.hasChatClientActivated){this.getShadowRoot().querySelector("rs-history").navigate(t)}else{const e=this.querySelector("template").content.querySelector("rs-history");e?.setAttribute("initial-path",t)}this.onChatClientMaximize()}setChatAppEventListeners(){const t=this.getShadowRoot().querySelector("rs-app");t&&(this.isEventListenersSet||(t.addEventListener("change-chat-app-state",this.onChatAppStateChange),t.addEventListener("change-chat-notifications-count",this.onChatNotificationsCountChange),t.addEventListener("multitask-notification",this.onChatMultitaskingNotification),t.addEventListener("open-image-modal",this.onChatOpenImageModal),t.addEventListener("location-change",this.onChatLocationChange),t.addEventListener("scc-created",this.onChatSccCreated),this.removeChatAppEventListeners=()=>{t.removeEventListener("change-chat-app-state",this.onChatAppStateChange),t.removeEventListener("change-chat-notifications-count",this.onChatNotificationsCountChange),t.removeEventListener("multitask-notification",this.onChatMultitaskingNotification),t.removeEventListener("open-image-modal",this.onChatOpenImageModal),t.removeEventListener("location-change",this.onChatLocationChange),t.removeEventListener("scc-created",this.onChatSccCreated),this.isEventListenersSet=!1},this.isEventListenersSet=!0))}canUseLightbox(){return!!document.querySelector("shreddit-media-lightbox")}updateChatClientTemplate(t){const e=this.querySelector("template").content.querySelector("rs-history");e?.setAttribute("initial-path",t)}updateNotificationCountInTheHeader(t){const e=document.getElementById("header-action-item-chat-button-badge");e&&e.setCount(t)}setUIState(t){this.uiState=t}toggleUIState(){if("maximized"===this.uiState){if(this.isMultitaskingEnabled)return this.onChatClientMinimize();this.onChatClientClose()}else this.onChatClientMaximize()}setFocusOnChatWidget(){this.initializeFocusManager(),this._focusManager?.focusFirst()}initializeFocusManager(){if(this._focusManager)return;const e=this.getShadowRoot().querySelector(".rs-app-container");e&&(this._focusManager=new t.aF(this,e))}resetToastAutoDismissTimer(){this.toastAutoDismissTimer?.clear(),this.toastAutoDismissTimer=void 0}dismissToast(){this.currentToast=null,this.resetToastAutoDismissTimer()}autoDismissToast(t,e=5e3){this.toastAutoDismissTimer=new it((()=>{this.currentToast?.eventId!==t||this.toastAutoDismissTimer?.isPaused||this.dismissToast()}),e)}renderChatClientTemplate(){if(!this.renderedTemplate){const t=this.querySelector("template");if("maximized"!==this.uiState){t.content.querySelector("rs-app").setAttribute("background","true")}const i=t.content.cloneNode(!0);this.renderedTemplate=e.x`${i}`}return this.renderedTemplate}renderMinimizedChatClient(){return e.x` <div class="relative group w-[130px] min-w-[130px] ${t.U({"w-[256px] min-w-[256px] h-[44px]":this.isMultitaskingEnabled})}" data-testid="minimized-chat-pill"> <button class="bg-transparent cursor-pointer border-none flex items-center py-sm pl-md pr-2xl w-100 h-100" aria-label="Maximize chat view" @click="${this.onChatClientMaximize}"> ${this.isMultitaskingEnabled?e.aw({size:e.I.Medium}):null} <p class="m-0 text-14 leading-4 font-sans ${t.U({"font-bold ml-2xs":this.isMultitaskingEnabled})}"> Chat </p> <dynamic-badge class="ml-xs" initial-count="${this.notificationCount}" appearance="${i.B.ALERT}"></dynamic-badge> </button> ${this.isMultitaskingEnabled&&!this.inDeniedPath?t.r({appearance:"plain",attributes:{className:"absolute right-xs top-1/2 -translate-y-1/2",onclick:this.onChatClientMaximize,type:"button","data-testid":"chat-expand-button"},leadingIcon:e.co({size:e.I.Small}),size:t.s.Small,screenReaderContent:"Expand chat"}):t.r({appearance:"plain",attributes:{className:"absolute right-xs top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 focus:opacity-100",onclick:this.onChatClientClose,type:"button","data-testid":"chat-close-button"},leadingIcon:e.C({size:e.I.ExtraSmall}),size:t.s.ExtraSmall,screenReaderContent:"Close chat"})} </div> `}renderToasts(){return this.currentToast?e.x`<div class="absolute bottom-2xl right-0"> ${tt({notification:this.currentToast,onClick:this.onChatToastClick,onClickNotificationSettings:this.onClickNotificationSettings,onPauseNotifications:this.onPauseNotifications,onRenderToast:this.onRenderToast,onOpenToastMenu:this.onOpenToastMenu,onCloseToastMenu:this.onCloseToastMenu})} </div>`:null}renderWithSizeControls(t){const i="maximized"===this.uiState;return e.x` <div class="group overflow-hidden rounded-tl-[16px] rounded-tr-[16px] border-sm border-solid border-neutral-border-weak border-b-0 shadow-md ${i?"h-full w-full min-h-[506px] max-h-[calc(100dvh_-_8rem)] min-w-[632px] max-w-[calc(100dvw_-_20rem)] has-[#resize-handle:focus]:rounded-tl-[4px] has-[#resize-handle:hover]:rounded-tl-[4px]":""}" id="resizable" style="${e.l(i?`width: ${this.dimensions.width}px; height: ${this.dimensions.height}px;`:void 0)}"> ${t} </div> `}render(){return"closed"!==this.uiState||this.hasChatClientActivated||this.isMultitaskingEnabled||this.preload?e.x` ${this.renderToasts()} ${this.renderWithSizeControls(e.x` <div class="${"closed"===this.uiState?"hidden":"relative transition-all ease-out duration-400 overflow-hidden bg-neutral-background"+("maximized"===this.uiState?" h-full":"")}" data-testid="reddit-chat-client"> <div class="${"maximized"!==this.uiState?"hidden":"h-full"}"> <faceplate-alert-reporter class="!relative h-full"> ${this.renderChatClientTemplate()} ${"maximized"===this.uiState?e.x` <reddit-chat-toaster class="absolute bottom-sm left-1/2 -translate-x-1/2 flex flex-col gap-xs"></reddit-chat-toaster> `:e.A} </faceplate-alert-reporter> </div> ${"minimized"===this.uiState?this.renderMinimizedChatClient():""} ${"maximized"===this.uiState&&this.resizable?e.x` <div tabindex="0" role="separator" id="resize-handle" class="h-[24px] w-[24px] absolute left-0 top-0 opacity-0 hover:opacity-100 focus:opacity-100 transition-opacity duration-400 ease-out cursor-nwse-resize" draggable="false" @pointerdown="${this.onPointerDownDiagonal}" @keydown="${this.onResizeHandleKeyDown}"> ${e.aZ({size:e.I.Small,attributes:{className:"-rotate-45 ease-out transition-transform duration-300"}})} </div> `:""} </div> `)} `:e.x``}};lt.styles=[t.t,e.a`:host{position:fixed;bottom:0;right:var(--spacer-xl);z-index:1}`,e.a`@keyframes fadeinout{0%{opacity:0}100%{opacity:1}}.toast{animation:fadeinout .1s linear forwards}`],lt.RESIZE_HANDLE_KEYDOWN_KEYS=new Set(["ArrowDown","ArrowUp","ArrowRight","ArrowLeft","r"]),t._([t.n({type:String})],lt.prototype,"country",void 0),t._([t.n({type:Boolean,attribute:"is-multitasking-enabled"})],lt.prototype,"isMultitaskingEnabled",void 0),t._([t.n({type:Boolean,attribute:"preload"})],lt.prototype,"preload",void 0),t._([t.n({type:Array,converter:t=>t?t.split(","):[],attribute:"deny-list"})],lt.prototype,"denyList",void 0),t._([t.n({type:Boolean,attribute:"resizable"})],lt.prototype,"resizable",void 0),t._([t.d()],lt.prototype,"uiState",void 0),t._([t.d()],lt.prototype,"notificationCount",void 0),t._([t.d()],lt.prototype,"currentToast",void 0),lt=st=t._([t.e("reddit-chat-host")],lt),SML.di("./matrix-js-sdk-cdd1fd93.js",import.meta.url,"matrixjssdkcdd1fd93").then((()=>SML.di("./dist-186ec01f.js",import.meta.url,"dist186ec01f")))}));