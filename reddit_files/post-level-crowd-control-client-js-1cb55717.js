SML.di("./shell-e48e5956.js",import.meta.url,"shelle48e5956");SML.di("./icon-c33661e6.js",import.meta.url,"iconc33661e6");SML.di("./age-gate-standalone-client-js-b13e879d.js",import.meta.url,"agegatestandaloneclientjsb13e879d");SML.di("./chat-mobile-xpromo-client-js-5e1c145c.js",import.meta.url,"chatmobilexpromoclientjs5e1c145c");SML.di("./faceplate-shimmer-9894306d.js",import.meta.url,"faceplateshimmer9894306d");
SML.dm("postlevelcrowdcontrolclientjs1cb55717",["shelle48e5956","iconc33661e6","agegatestandaloneclientjsb13e879d","chatmobilexpromoclientjs5e1c145c","faceplateshimmer9894306d"],(async(t,e,l,s)=>{let a=class extends e.s{constructor(){super(...arguments),this.isLoading=!0,this.isSubmittable=!1,this.postId="",this._windowEvents=new t.E(this,(()=>window)),this.handleOpenModalEvent=this._windowEvents.define(s.O,(async t=>{this.isSubmittable=!1,this.isLoading=!0,this.showModal(),await this.activateFormContentFeature(t.detail.postId),this.postId=t.detail.postId,this.isLoading=!1}))}get oldPostLevel(){return this.querySelector('[name="old-post-level"]')?.value}get oldIsFilterEnabled(){return"true"===this.querySelector('[name="old-is-filter-enabled"]')?.value}activateFormContentFeature(e){return t.k({name:t.bM,routeParams:{postId:e},renderMode:t.o.Contents})}showModal(){this.modal?.showModal()}closeModal(){this.modal?.close()}buildAlert(e){const s=e?t.x.success:t.x.error;return this.dispatchEvent(t.c("faceplate-alert",{level:s,message:l.a9(e)}))}async onSave(){const t=this.querySelector('[name="post-level"][checked]'),e=this.querySelector('[name="is-filter-enabled"]');t?.value&&e?(this.submitRequest(t.value,null!=e.value),this.emitV2Event(t.value,null!=e.value)):(this.buildAlert(!1),this.isSubmittable=!0)}async submitRequest(t,e){try{this.isSubmittable=!1;const l=await this.invokeGQL(t,e);this.inspectResp(l)}catch(t){this.buildAlert(!1),this.isSubmittable=!0}}invokeGQL(e,l){return t.B({operation:t.O.UpdatePostLevelCrowdControlSettings,variables:{id:this.postId,level:e,filterIsEnabled:l,shouldIncludeUpdatePostCrowdControlFilter:l!==this.oldIsFilterEnabled,shouldIncludeUpdatePostCrowdControlLevel:e!==this.oldPostLevel}})}inspectResp(t){let e=!1;"updatePostCrowdControlFilter"in t.data&&"updatePostCrowdControlLevel"in t.data?t.data.updatePostCrowdControlFilter?.ok&&t.data.updatePostCrowdControlLevel?.ok&&(e=!0):"updatePostCrowdControlFilter"in t.data?t.data.updatePostCrowdControlFilter?.ok&&(e=!0):"updatePostCrowdControlLevel"in t.data&&t.data.updatePostCrowdControlLevel?.ok&&(e=!0),e?(this.buildAlert(!0),this.closeModal()):(this.buildAlert(!1),this.isSubmittable=!0)}isContentLoading(){return this.isLoading}emitV2Event(t,e){const l=this.querySelector('[name="subreddit-id"]'),s=this.querySelector('[name="subreddit-name"]'),a={id:l?.value||"",name:s?.value||""},i=this.querySelector('[name="author-id"]'),o={id:this.postId,author:{id:i?.value||""}};this.buildAndTrack("crowd_control_individual_post",o,a,{value:t,old_value:`${this.oldPostLevel}`}),this.buildAndTrack("crowd_control_individual_post_filter",o,a,{value:`${e}`,old_value:`${this.oldIsFilterEnabled}`})}buildAndTrack(e,l,s,a){const i={post:l,subreddit:s,setting:a},o=t.b({source:"post_mod_action_menu",action:"save",noun:e},i);t.a(this,o)}handleInput(){this.isSubmittable=!0}render(){return e.x` <faceplate-modal inFocusTrap class="max-w-md w-full"> <div slot="title"> Adjust post crowd control </div> <div slot="closeButton"> ${t.r({appearance:"secondary",leadingIcon:e.C({size:e.I.Small}),size:t.s.Small,attributes:{type:"button",onclick:this.closeModal}})} </div> ${this.isLoading?e.x`<div class="w-full"> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-2/3 h-lg"></faceplate-shimmer> </div>`:e.x`<slot @input="${this.handleInput}"></slot>`} <div slot="primaryButton"> ${t.r({children:"Save",appearance:"primary",attributes:{type:"submit",onclick:this.onSave,disabled:!this.isSubmittable}})} </div> <div slot="secondaryButton"> ${t.r({children:"Cancel",appearance:"plain",attributes:{type:"button",onclick:this.closeModal}})} </div> </faceplate-modal> `}};a.styles=[t.t],t._([t.d()],a.prototype,"isLoading",void 0),t._([t.d()],a.prototype,"isSubmittable",void 0),t._([t.d()],a.prototype,"postId",void 0),t._([t.y("faceplate-modal")],a.prototype,"modal",void 0),a=t._([t.e("post-level-crowd-control-modal")],a)}));