SML.di("./shell-e48e5956.js",import.meta.url,"shelle48e5956");SML.di("./icon-c33661e6.js",import.meta.url,"iconc33661e6");SML.di("./render-saved-response-template-by-subreddit-id-b78cebab.js",import.meta.url,"rendersavedresponsetemplatebysubredditidb78cebab");SML.di("./awards-2379b181.js",import.meta.url,"awards2379b181");SML.di("./age-gate-standalone-client-js-b13e879d.js",import.meta.url,"agegatestandaloneclientjsb13e879d");SML.di("./faceplate-form-cff507f5.js",import.meta.url,"faceplateformcff507f5");SML.di("./community-picker-f331f77f.js",import.meta.url,"communitypickerf331f77f");SML.di("./comment-5b02ad76.js",import.meta.url,"comment5b02ad76");SML.di("./overflow-menu-actions-f8d12b95.js",import.meta.url,"overflowmenuactionsf8d12b95");SML.di("./links-22118b0c.js",import.meta.url,"links22118b0c");SML.di("./rpl-filter-chip-3ad19f7c.js",import.meta.url,"rplfilterchip3ad19f7c");SML.di("./header-action-item-chat-client-js-b3335fba.js",import.meta.url,"headeractionitemchatclientjsb3335fba");SML.di("./faceplate-select-text-input-bad79e01.js",import.meta.url,"faceplateselecttextinputbad79e01");SML.di("./faceplate-option-7a297e33.js",import.meta.url,"faceplateoption7a297e33");SML.di("./rpl-coachmark-4e17786a.js",import.meta.url,"rplcoachmark4e17786a");SML.di("./rpl-coachmark-card-5c5498b1.js",import.meta.url,"rplcoachmarkcard5c5498b1");SML.di("./utils-93db03dd.js",import.meta.url,"utils93db03dd");SML.di("./tooltip.base-aa9651a3.js",import.meta.url,"tooltipbaseaa9651a3");SML.di("./constants-9e09f052.js",import.meta.url,"constants9e09f052");SML.di("./chat-mobile-xpromo-client-js-5e1c145c.js",import.meta.url,"chatmobilexpromoclientjs5e1c145c");SML.di("./faceplate-textarea-input-29f541e5.js",import.meta.url,"faceplatetextareainput29f541e5");SML.di("./smart-escalations-provider-client-js-1b1b1602.js",import.meta.url,"smartescalationsproviderclientjs1b1b1602");SML.di("./distinguished-tags-1c4757ea.js",import.meta.url,"distinguishedtags1c4757ea");SML.di("./table-pagination-77cf692d.js",import.meta.url,"tablepagination77cf692d");SML.di("./select-controller-4c63b3e8.js",import.meta.url,"selectcontroller4c63b3e8");SML.di("./user-flair-fe275854.js",import.meta.url,"userflairfe275854");SML.di("./utils-57a7018c.js",import.meta.url,"utils57a7018c");SML.di("./text-input-9c3f45be.js",import.meta.url,"textinput9c3f45be");SML.di("./community-onboarding-completed-modal-client-js-f4f5192c.js",import.meta.url,"communityonboardingcompletedmodalclientjsf4f5192c");SML.di("./hui-user-drawer-client-js-91e856a7.js",import.meta.url,"huiuserdrawerclientjs91e856a7");SML.di("./TinyGesture-26737d23.js",import.meta.url,"TinyGesture26737d23");
SML.dm("modremovalreasonformclientjsba8e4d27",["shelle48e5956","iconc33661e6","rendersavedresponsetemplatebysubredditidb78cebab","awards2379b181","agegatestandaloneclientjsb13e879d","faceplateformcff507f5","communitypickerf331f77f","comment5b02ad76","overflowmenuactionsf8d12b95","links22118b0c","headeractionitemchatclientjsb3335fba","utils93db03dd","tooltipbaseaa9651a3","constants9e09f052","smartescalationsproviderclientjs1b1b1602","rplfilterchip3ad19f7c","faceplateselecttextinputbad79e01","faceplateoption7a297e33","rplcoachmark4e17786a","rplcoachmarkcard5c5498b1","chatmobilexpromoclientjs5e1c145c","faceplatetextareainput29f541e5","distinguishedtags1c4757ea","tablepagination77cf692d","selectcontroller4c63b3e8","userflairfe275854","utils57a7018c","textinput9c3f45be","communityonboardingcompletedmodalclientjsf4f5192c","huiuserdrawerclientjs91e856a7","TinyGesture26737d23"],(async(e,t,a,s,o,n,i,l,r,d,c,m,u,p,h)=>{const v="dont-notify-tooltip-close",g="removal-reason-input-changed",{svg:E}=t.g();var R=t.d(E`<path d="M17.153 6.75H15.9A2.753 2.753 0 0 0 13.153 4V2.75A2.753 2.753 0 0 0 15.9 0h1.25a2.752 2.752 0 0 0 2.75 2.75V4a2.752 2.752 0 0 0-2.747 2.75ZM15.3 3.375c.494.316.914.735 1.23 1.23a4.02 4.02 0 0 1 1.23-1.23 4.02 4.02 0 0 1-1.23-1.23 4.033 4.033 0 0 1-1.23 1.23ZM9.216 20h-1.33l-.085-.526c-.725-4.557-2.684-6.521-7.224-7.248l-.526-.084v-1.284l.527-.084c4.54-.727 6.5-2.691 7.224-7.248L7.886 3h1.33l.084.526c.725 4.557 2.684 6.521 7.225 7.248l.526.084v1.284l-.526.084c-4.541.727-6.5 2.691-7.225 7.248L9.216 20Zm-6.234-8.5a7.858 7.858 0 0 1 5.569 5.634 7.858 7.858 0 0 1 5.57-5.634 7.859 7.859 0 0 1-5.57-5.634A7.858 7.858 0 0 1 2.98 11.5Z"></path>`,"0 0 20 20","ai-outline");class b extends CustomEvent{constructor(e){super(b.eventName,{detail:e,bubbles:!0,composed:!0})}}b.eventName="select-suggested-removal-reason";let S=class extends t.s{constructor(){super(...arguments),this.reasons=[],this.suggestions=[],this.eventContext={}}getReasonNumber(e){const t=this.reasons.findIndex((t=>t.id===e));return t>=0?t+1:0}getSelectedChip(){return this.shadowRoot?.querySelector('rpl-filter-chip[name="removal-reason-suggestion"][selected]')??null}render(){return t.x` <div class="my-xs w-fit"> ${R({size:t.I.ExtraSmall})} Suggested <rpl-tooltip appearance="inverted" trigger="hover focus" placement="right" @click="${e=>e.preventDefault()}"> ${t.$({size:t.I.ExtraSmall})} <span slot="content" class="pointer-events-auto"> Suggestions based on the content, your rules, and your removal reasons. <a href="https://support.reddithelp.com/hc/articles/15484471320980-Saved-Responses" target="_blank" class="text-inverted-neutral-content-strong" @click="${e=>e.stopPropagation()}"> Learn more </a> </span> </rpl-tooltip> <div class="flex flex-col gap-xs mt-xs"> ${this.suggestions.map((e=>{const a=this.getReasonNumber(e.id);return t.x` <faceplate-tracker source="moderator" action="click" noun="removal_reason_recommendation" data-faceplate-tracking-context="${JSON.stringify({action_info:{reason:e.id},subreddit:{id:this.eventContext.subredditId},post:{id:this.eventContext.postId},comment:{id:this.eventContext.commentId}})}" @click="${e=>{e.preventDefault(),e.stopPropagation()}}"> <rpl-filter-chip name="removal-reason-suggestion" class="max-w-fit" appearance="bordered" data-removal-reason-id="${e.id}" ?selected="${this.value===e.id}" @click="${()=>{this.dispatchEvent(new b({reasonId:e.id}))}}">${a?`${a}. `:""}${e.title}</rpl-filter-chip> </faceplate-tracker> `}))} </div> </div> `}};S.styles=[e.t],e._([e.n({type:Array})],S.prototype,"reasons",void 0),e._([e.n({type:Array})],S.prototype,"suggestions",void 0),e._([e.n({type:Object,attribute:"event-context"})],S.prototype,"eventContext",void 0),e._([e.n()],S.prototype,"value",void 0),S=e._([e.e("removal-reason-suggestions")],S);let y=class extends t.s{constructor(){super(...arguments),this._showCoachmark=!localStorage.getItem(this.getLocalStorageKey()),this.closeCoachmark=e=>{e.stopPropagation(),this._showCoachmark=!1},this.handleLearnMore=e=>{e.stopPropagation(),window.open("https://support.reddithelp.com/hc/articles/15484471320980-Saved-Responses","_blank")}}getLocalStorageKey(){return e.L.RemovalReasonSuggestionsCoachmarkSeen}connectedCallback(){super.connectedCallback();localStorage.getItem(this.getLocalStorageKey())?this._showCoachmark=!1:(localStorage.setItem(this.getLocalStorageKey(),"true"),this._showCoachmark=!0)}disconnectedCallback(){super.disconnectedCallback()}render(){return t.x`<rpl-coachmark placement="${m.P.Bottom}" appearance="${u.a.Inverted}" ?open="${this._showCoachmark}" class="w-[270px]"> <slot></slot> <rpl-coachmark-card slot="content" aria-live="polite" appearance="${u.a.Inverted}" class="w-[270px]"> <div slot="title" class="pt-xs pb-2xs"> <div> Save time with suggested removal reasons </div> </div> ${e.r({attributes:{className:"close-btn",slot:"close-button",onclick:e=>{e.stopPropagation(),this.closeCoachmark(e)}},appearance:"plainInverted",size:e.s.Small,leadingIcon:t.C({size:t.I.Small})})} <div class="text-12 mb-sm"> Based on the content, your rules, and your removal reasons, we\u2019ll suggest the most likely removal reasons. </div> ${e.r({attributes:{slot:"secondary-button",onclick:this.handleLearnMore},children:"Learn More",appearance:"plainInverted",size:e.s.Small})} ${e.r({attributes:{slot:"primary-button",onclick:this.closeCoachmark},children:"Got It",appearance:"plainInverted",size:e.s.Small})} </rpl-coachmark-card> </rpl-coachmark>`}};y.styles=[e.t],e._([e.d()],y.prototype,"_showCoachmark",void 0),y=e._([e.e("removal-reason-suggestions-coachmark")],y);class f extends p.F{constructor(){super(...arguments),this.isInputDirty=!1,this.required=!1,this.handleSubmit=()=>{this.isInputDirty=!0},this.handleInvalid=e=>{e.preventDefault()}}get value(){const e=this._internals.getFormValue();return e?e.toString():null}set value(e){e!==this.value&&(this._internals.setFormValue(e),this.updateValidity(),this.dispatchEvent(new CustomEvent(g,{detail:{value:e},bubbles:!0})))}connectedCallback(){super.connectedCallback(),i.c(this).then((e=>{e?.addEventListener("faceplate-submit",this.handleSubmit)})),this.addEventListener("invalid",this.handleInvalid),this.updateValidity()}disconnectedCallback(){super.disconnectedCallback(),this.form?.removeEventListener("faceplate-submit",this.handleSubmit),this.removeEventListener("invalid",this.handleInvalid)}updateValidity(){this.required&&!this.value?this._internals.setValidity({valueMissing:!0},this.getValueMissingValidationMessage()):this._internals.setValidity(),this.requestUpdate()}getValueMissingValidationMessage(){return""}renderValidationState(){return this.isInputDirty&&this.validationMessage?t.x`<span class="text-12 text-danger-content px-md">${this.validationMessage}</span>`:null}}e._([e.d()],f.prototype,"isInputDirty",void 0),e._([e.n({type:Boolean})],f.prototype,"required",void 0);class _ extends CustomEvent{constructor(e){super(_.eventName,{detail:e,bubbles:!0,composed:!0})}}_.eventName="select-removal-reason";let I=class extends f{constructor(){super(...arguments),this.isSitewide=!1,this.selectedRemovalReason=this.value,this.handleSelectSuggestedRemovalReason=e=>{this.selectReasonById(e.detail.reasonId,!1)},this.handleSelect=e=>{const t=e.target;this.selectReasonById(t.value)}}get displayText(){return this.reasons?.find((e=>e.id===this.value))?.title||""}static get styles(){return[e.t,t.a`:host{display:flex;flex-direction:column}`]}getValueMissingValidationMessage(){return"Removal reason is required."}getPlatformRuleOption(){return{id:"default-removal-reason",title:"Breaking platform rules",message:""}}selectReasonById(e,t=!0){const a=(this.includePlatformRuleOption?[...this.reasons||[],this.getPlatformRuleOption()]:this.reasons||[]).find((t=>t.id===e));a&&this.selectedRemovalReason!==a.id&&(this.selectedRemovalReason=a.id,this.value=a.id,this.dispatchEvent(new _({...a,isSitewide:this.isSitewide,trackEvent:t})))}getDropdownPlaceholder(){return this.isSitewide?"Select a platform rule":"Select a removal reason"}connectedCallback(){super.connectedCallback(),this.addEventListener(b.eventName,this.handleSelectSuggestedRemovalReason)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(b.eventName,this.handleSelectSuggestedRemovalReason)}render(){return t.x` <label class="text-16 text-neutral-content-strong"> ${super.render()} </label> <faceplate-select-text-input label="${this.getDropdownPlaceholder()}" value="${this.selectedRemovalReason}" readonly="readonly" style="--faceplate-select-menu-max-height:350px;-faceplate-select-menu-max-width:80vw" @faceplate-select-text-input:change="${this.handleSelect}"> ${this.reasons?.map(((e,a)=>t.x`<faceplate-option value="${e.id}" display-text="${e.title}" ?selected="${e.id===this.selectedRemovalReason}"><span slot="leading" class="whitespace-nowrap text-16">${a+1}</span></faceplate-option>`))} ${this.includePlatformRuleOption&&t.x`<faceplate-option value="default-removal-reason" display-text="${this.getPlatformRuleOption().title}"></faceplate-option>`} ${this.includeAddRemovalReasonOption&&t.x`<faceplate-option value="add-removal-reason"> <slot name="link"></slot> </faceplate-option>`} </faceplate-select-text-input> ${this.renderValidationState()} ${this.removalReasonSuggestionsContext?.predictedRemovalSavedResponses&&this.removalReasonSuggestionsContext?.predictedRemovalSavedResponses.length>0?t.x` <removal-reason-suggestions-coachmark> <removal-reason-suggestions class="block w-fit" reasons="${JSON.stringify(this.reasons)}" suggestions="${JSON.stringify(this.removalReasonSuggestionsContext.predictedRemovalSavedResponses)}" event-context="${JSON.stringify(this.removalReasonSuggestionsContext.eventContext)}" value="${this.selectedRemovalReason}"></removal-reason-suggestions> </removal-reason-suggestions-coachmark> `:""} `}};e._([e.n({type:Array})],I.prototype,"reasons",void 0),e._([e.n({type:Boolean,attribute:"is-sitewide"})],I.prototype,"isSitewide",void 0),e._([e.n({type:Boolean,attribute:"include-platform-rule-option"})],I.prototype,"includePlatformRuleOption",void 0),e._([e.n({type:Boolean,attribute:"include-add-removal-reason-option"})],I.prototype,"includeAddRemovalReasonOption",void 0),e._([e.n({type:Object,attribute:"removal-reason-suggestions-context"})],I.prototype,"removalReasonSuggestionsContext",void 0),e._([e.d()],I.prototype,"selectedRemovalReason",void 0),I=e._([e.e("removal-reason-input")],I);const{svg:T}=t.g();var M=t.d(T`<path d="m16.784 9.5 2.558 2.558-.884.884-2.558-2.558-2.558 2.558-.884-.884L15.016 9.5l-2.558-2.558.884-.884L15.9 8.616l2.558-2.558.884.884L16.784 9.5Zm-6.427 10.248A1.128 1.128 0 0 0 11 18.715V1.286a1.131 1.131 0 0 0-.643-1.034A1.091 1.091 0 0 0 9.19.405L3.815 5.056H2.108A1.124 1.124 0 0 0 1 6.194v7.613a1.124 1.124 0 0 0 1.108 1.138h1.707L9.2 19.608a1.084 1.084 0 0 0 1.157.14ZM2.25 6.306h2.031l5.47-4.733v16.855L4.28 13.7h-2.03V6.306Z"></path>`,"0 0 20 20","mute-outline");let D=class extends c.R{constructor(){super(),this.tooltipVisible=!1,this.trigger="manual",this.placement="top",this.appearance="neutral"}connectedCallback(){super.connectedCallback(),this.initializeTooltip(),this.addEventListener(v,this.hideTooltip)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(v,this.hideTooltip)}async initializeTooltip(){e.l.getItem(e.L.RemovalReasonDontNotifyDismissed)||setTimeout((()=>this.showTooltip()),750)}showTooltip(){this.show()}hideTooltip(t){t.stopPropagation(),e.l.setItem(e.L.RemovalReasonDontNotifyDismissed,"true"),this.hide()}};e._([e.d()],D.prototype,"tooltipVisible",void 0),D=e._([e.e("dont-notify-tooltip")],D);let C=class extends t.s{constructor(){super(...arguments),this.isAIModEnabledForSubreddit=!1}handleClose(){this.dispatchEvent(new CustomEvent(v,{bubbles:!0}))}render(){return t.x` <div class="pointer-events-auto py-xs pl-xs w-[200px]"> <div class="flex flex-row"> <div> <div class="text-14 font-bold text-neutral-content-strong"> Don't want to notify? </div> <div class="text-12 font-normal text-neutral-content-strong"> ${this.isAIModEnabledForSubreddit?"Use removal reasons to train automations and track mod actions without notifying users.":"Use removal reasons to track mod actions without notifying users."} </div> </div> ${e.r({appearance:"secondary",leadingIcon:t.C({size:t.I.Small}),size:e.s.Small,screenReaderContent:"Close tooltip",attributes:{type:"button",className:"flex-shrink-0 -mt-xs",onclick:this.handleClose}})} </div> <div class="flex justify-end mt-md"> ${e.r({appearance:"plain",size:e.s.Small,children:"Okay",attributes:{type:"button",onclick:this.handleClose}})} </div> </div> `}};var L;C.styles=[e.t],e._([e.n({type:Boolean,attribute:"is-ai-mod-enabled-for-subreddit"})],C.prototype,"isAIModEnabledForSubreddit",void 0),C=e._([e.e("dont-notify-tooltip-content")],C),function(e){e.Comment="Comment",e.Modmail="Modmail",e.DontNotify="DontNotify"}(L||(L={}));let x=class extends f{constructor(){super(...arguments),this.isModmailAllowed=!1,this.isAIModEnabledForSubreddit=!1}static get styles(){return[e.t,t.a`:host{display:flex;flex-direction:column;gap:var(--spacer-xs)}`]}connectedCallback(){super.connectedCallback(),this.value=L.Comment}getValueMissingValidationMessage(){return"Please select the notification method."}render(){return t.x` <label class="text-16 text-neutral-content-strong"> ${this._internals.input} Notify user via </label> <div class="flex flex-row gap-xs"> ${e.r({appearance:"bordered",children:"Comment",leadingIcon:t.a8({size:t.I.Small}),selected:this.value===L.Comment,attributes:{type:"button",onclick:()=>{this.value=L.Comment,this.requestUpdate()}}})} ${this.isModmailAllowed?e.r({appearance:"bordered",children:"Mod Mail",leadingIcon:t.aO({size:t.I.Small}),selected:this.value===L.Modmail,attributes:{type:"button",onclick:()=>{this.value=L.Modmail,this.requestUpdate()}}}):t.A} <dont-notify-tooltip> ${e.r({appearance:"bordered",children:"Don't Notify",leadingIcon:M({size:t.I.Small}),selected:this.value===L.DontNotify,attributes:{type:"button",onclick:()=>{this.value=L.DontNotify,this.requestUpdate()}}})} <dont-notify-tooltip-content ?is-ai-mod-enabled-for-subreddit="${this.isAIModEnabledForSubreddit}" slot="content"></dont-notify-tooltip-content> </dont-notify-tooltip> </div> ${this.renderValidationState()} `}};var A;e._([e.n({type:Boolean,attribute:"is-mod-mail-allowed"})],x.prototype,"isModmailAllowed",void 0),e._([e.n({type:Boolean,attribute:"is-ai-mod-enabled-for-subreddit"})],x.prototype,"isAIModEnabledForSubreddit",void 0),x=e._([e.e("removal-reason-notification-method")],x),function(e){e.User="User",e.Mod="Mod"}(A||(A={}));let k=class extends f{static get styles(){return[e.t,t.a`:host{display:flex;flex-direction:column;gap:var(--spacer-xs)}`]}connectedCallback(){super.connectedCallback(),this.value=A.Mod}getValueMissingValidationMessage(){return"Please select the notification sender."}render(){return t.x` <label class="text-16 text-neutral-content-strong"> ${this._internals.input} Send message as </label> <div class="flex flex-row gap-xs"> ${e.r({appearance:"bordered",children:"Mod Team",leadingIcon:t.x`<slot name="mod-icon"></slot>`,selected:this.value===A.Mod&&!this.disabled,attributes:{type:"button",disabled:this.disabled,onclick:()=>{this.value=A.Mod,this.requestUpdate()}}})} ${e.r({appearance:"bordered",children:this.user,leadingIcon:t.x`<slot name="user-icon"></slot>`,selected:this.value===A.User&&!this.disabled,attributes:{type:"button",disabled:this.disabled,onclick:()=>{this.value=A.User,this.requestUpdate()}}})} </div> ${this.renderValidationState()} `}};e._([e.n()],k.prototype,"user",void 0),k=e._([e.e("removal-reason-notification-sender")],k);class O extends CustomEvent{constructor(e){super(O.eventName,{bubbles:!0,composed:!0,cancelable:!0,detail:e})}}O.eventName="mod-removal-reason-added";class w extends CustomEvent{constructor(e){super(w.eventName,{bubbles:!0,composed:!0,cancelable:!0,detail:e})}}w.eventName="removal-reason-form-element-clicked";let N=class extends(e.C(n.F)){constructor(){super(),this._eventController=new e.E(this),this.handleFormElementClicked=e=>{e.target?.name&&this.dispatchEvent(new w({formElement:e.target.name}))},this.handleRemovalReasonInputChanged=e=>{if(e.target instanceof x){const t=e.target.value!==L.DontNotify;this.toggleNotificationSender(t),this.toggleMessageInput(t)}e.target instanceof I&&"removal-reason"===e.target.name&&this.toggleDefaultPolicyInput("default-removal-reason"===e.target.value)},this.convertFormDataToGql=e=>{const t=e.get("notification-method"),a=e.get("notification-sender"),s={reasonId:this.getRemovalReasonId(e),type:this.parseRemovalReasonMessageType(t,a),message:t===L.DontNotify?null:e.get("message"),isLockComment:e.has("lock")},o=e.get("modNote")||void 0,n={itemId:e.get("thing")?.toString()||"",removalReason:s,modNote:o};return this.lastSubmittedData=n,JSON.stringify({...n,csrf_token:e.get("csrf_token")})},this.encoders={...this.encoders,"application/json":this.convertFormDataToGql}}connectedCallback(){super.connectedCallback(),this._eventController.define(g,this.handleRemovalReasonInputChanged),this._eventController.define("click",this.handleFormElementClicked)}toggleNotificationSender(e){const t=this.elements["notification-sender"];t&&(e?t.removeAttribute("disabled"):t.setAttribute("disabled",""))}toggleField(e,t){e&&(t?(e.classList.remove("hidden"),e.setAttribute("required","")):(e.classList.add("hidden"),e.removeAttribute("required")))}toggleMessageInput(e){const t=this.elements.message;t&&this.toggleField(t,e)}toggleDefaultPolicyInput(e){const t=this.elements["default-removal-reason"];t&&this.toggleField(t,e)}showError(){const t={level:e.x.error,message:"Something went wrong",cause:e.ag.QueryBadResponse};this.dispatchEvent(e.c("faceplate-alert",t))}async handleResponse(t){if(!t.ok)return this.dispatchEvent(e.c($.eventName)),this.showError();try{const a=await t.text(),s={level:e.x.success,message:"Removal reason added"},o=this.lastSubmittedData?.itemId||"";if(d.l(o)){const t={postId:o,action:r.a.addRemovalReason,value:!0};this.publish(e.T.PostUpdated,t)}else{const t={commentId:o,action:l.C.addRemovalReason,value:!0};this.publish(e.T.CommentUpdated,t)}if(a){const t={parentThingId:o,body:a};this.publish(e.T.CommentCreated,t)}this.dispatchEvent(e.c($.eventName)),this.dispatchEvent(e.c("faceplate-alert",s)),this.lastSubmittedData&&this.dispatchEvent(new O(this.lastSubmittedData))}catch{this.showError()}}parseRemovalReasonMessageType(t,a){return t===L.Comment?a===A.Mod?e.gM.CommentAsSubreddit:e.gM.CommentAsMod:t===L.Modmail?a===A.Mod?e.gM.MessageAsSubreddit:e.gM.MessageAsMod:null}getRemovalReasonId(e){const t=e.get("removal-reason");return"default-removal-reason"===t?e.get("default-removal-reason"):t}};N=e._([e.e("removal-reason-form")],N),i.r(N);const P={"removal-reason":"subreddit_removal_reason","default-removal-reason":"default_removal_reason",message:"message_to_user","notification-method":"notification_method","notification-sender":"notification_sender",modNote:"mod_note"};class H extends CustomEvent{constructor(e){super(H.eventName,{detail:e,bubbles:!0,composed:!0})}}H.eventName="mod-add-removal-reason-show-modal";class $ extends CustomEvent{constructor(){super($.eventName)}}$.eventName="mod-add-removal-reason-toggle-loading";let j=class extends t.s{constructor(){super(...arguments),this.pubsub=new e.P(this),this.getInputValue=e=>this.removalReasonForm?.querySelector(`input[name="${e}"]`)?.value,this.buildAndTrackEvent=t=>{const a={action:"click",...t,authorId:this.getInputValue("authorId"),subredditId:this.getInputValue("subredditId"),subredditName:this.subredditName,thingId:this.thingId};e.a(this,s.y(a))},this.firstUpdated=()=>{this.isSmartEscalationsCommunityRulesEnabled&&this.updateComplete.then((()=>{this.primaryButton?.addEventListener("click",(()=>{this.removalReasonForm?.isValid&&(this.toggleButtonLoadingIndicator(),this.initSmartEscalations())}))}))},this.handleAddRemovalReasonEvent=({detail:e})=>{""!==e?this.show(e):this.thingId=void 0},this.handleFormElementClicked=e=>{const t={type:P[e.detail.formElement]||e.detail.formElement},a=this.removalReasonForm?.elements[e.detail.formElement]?.value||this.getInputValue(e.detail.formElement);if("lock"===e.detail.formElement&&(t.isLocked="on"===a),"notification-method"===e.detail.formElement){if(!a)return;t.notificationMethod=a}if("notification-sender"===e.detail.formElement){if(!a)return;t.sendAs=a}this.buildAndTrackEvent(t)},this.handleSelectRemovalReason=async e=>{const t=this.removalReasonInput?.removalReasonSuggestionsContext;e.detail.trackEvent&&this.buildAndTrackEvent({type:e.detail.isSitewide?"default_removal_reason":"subreddit_removal_reason",reason:e.detail.id,noun:"removal_reason_select",subredditId:t?.eventContext?.subredditId,postId:t?.eventContext?.postId,commentId:t?.eventContext?.commentId});const a=this.removalReasonForm,s=this.shadowRoot?.querySelector("faceplate-textarea-input");s&&e.detail.message&&(s.value=await this.renderRemovalReasonMessage(e.detail.id,e.detail.message),await s.updateComplete,s.syncInputValidity(),a?.notifyObservers(s))},this.renderRemovalReasonMessage=async(e,t)=>{try{return await this.renderRemovalReasonAsSavedResponseTemplate(e)}catch{return t}},this.renderSavedResponseTemplateBySubredditId=a.r,this.renderRemovalReasonAsSavedResponseTemplate=e=>this.renderSavedResponseTemplateBySubredditId({responseId:e,subredditId:this.getInputValue("subredditId")||"",contentId:this.thingId}),this.handleAddedRemovalReason=t=>{let a=function(t){let a;a=t.type===e.gM.CommentAsMod||t.type===e.gM.CommentAsSubreddit?"comment":t.type===e.gM.MessageAsMod||t.type===e.gM.MessageAsSubreddit?"modmail":"no message";const s=t.type===e.gM.CommentAsSubreddit||t.type===e.gM.MessageAsSubreddit?"subreddit":"self";return{is_locked:t.isLockComment,notify:a,send_as:s}}(t.detail.removalReason);const o=this.removalReasonInput?.removalReasonSuggestionsContext?.predictedRemovalSavedResponses?.map((e=>e.id));o&&(a={...a,suggestion_list:o}),e.a(this,s.z(a,this.removalReasonInput?.value??void 0,this.removalReasonInput?.removalReasonSuggestionsContext?.eventContext)),this.isSmartEscalationsCommunityRulesEnabled&&!this.isExpandSuggestedActionsEnabled?(this.buildAndTrackEvent({type:"submit_button",reason:"default-removal-reason"===this.removalReasonInput?.value?this.defaultRemovalReasonInput?.value??void 0:this.removalReasonInput?.value??void 0,notificationMethod:this.removalReasonForm?.elements["notification-method"]?.value,sendAs:this.removalReasonForm?.elements["notification-sender"]?.value,isLocked:"on"===this.getInputValue("lock"),modNote:this.getInputValue("modNote"),message:this.getInputValue("message")}),this.pubsub.publish(e.T.RemovalReasonStatus,h.R.SUCCESS)):this.close()},this.handleCancel=t=>{t.stopImmediatePropagation(),this.buildAndTrackEvent({type:"close_button"}),e.a(this,s.A()),this.close()},this.toggleButtonLoadingIndicator=()=>{this.primaryButton?.querySelector("faceplate-progress")?.classList.toggle("hidden"),this.primaryButton?.querySelector("span.submit-button-content")?.classList.toggle("opacity-0")},this.showHideSubmitButton=()=>{this.removalReasonInput?this.primaryButton?.classList.remove("hidden"):this.primaryButton?.classList.add("hidden")},this.close=()=>{this.modal?.open&&(this.modal?.close(),document.body.style.overflow="auto",document.body.style.pointerEvents="auto")},this.initSmartEscalations=()=>{const t=this.getInputValue("authorId"),a=this.getInputValue("subredditId"),s=t&&a&&this.thingId;s&&this.pubsub.publish(e.T.SmartEscalationsInit,{thingId:this.thingId,authorId:t,subredditId:a,removalReasonId:(this.defaultRemovalReasonInput?.value||this.removalReasonInput?.value)??"",removalReasonDisplayText:(this.defaultRemovalReasonInput?.displayText||this.removalReasonInput?.displayText)??""}),!s&&this.close()}}get removalReasonInput(){return this.shadowRoot?.querySelector('[name="removal-reason"]')}get defaultRemovalReasonInput(){return this.shadowRoot?.querySelector('[name="default-removal-reason"]')}get removalReasonForm(){return this.shadowRoot?.querySelector("removal-reason-form")}get primaryButton(){return this.shadowRoot?.querySelector('faceplate-modal [slot=primaryButton] button[type="submit"]')}get selectedSuggestionValue(){const e=this.removalReasonInput?.shadowRoot?.querySelector("removal-reason-suggestions"),t=e?.getSelectedChip();return t?.dataset.removalReasonId}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.AddRemovalReasonClose,this.close,!1),this.addEventListener(_.eventName,this.handleSelectRemovalReason),this.addEventListener(O.eventName,this.handleAddedRemovalReason),this.addEventListener($.eventName,this.toggleButtonLoadingIndicator),this.addEventListener(w.eventName,this.handleFormElementClicked),window.addEventListener(H.eventName,this.handleAddRemovalReasonEvent)}disconnectedCallback(){super.disconnectedCallback(),this.pubsub.unsubscribe(e.T.AddRemovalReasonClose,this.close),window.removeEventListener(H.eventName,this.handleAddRemovalReasonEvent),this.removeEventListener(_.eventName,this.handleSelectRemovalReason),this.removeEventListener(O.eventName,this.handleAddedRemovalReason),this.removeEventListener($.eventName,this.toggleButtonLoadingIndicator),this.addEventListener(w.eventName,this.handleFormElementClicked)}async show(e){e&&(this.thingId=e,await this.updateComplete),this.modal?.showModal(),await(this.partial?.load()),this.buildAndTrackEvent({action:"view"}),this.primaryButton?.querySelector("faceplate-progress")?.classList.add("hidden"),this.primaryButton?.querySelector("span.submit-button-content")?.classList.remove("opacity-0"),this.showHideSubmitButton()}render(){return t.x` <removal-reason-form class="mb-0" enctype="application/json" method="POST" action="/svc/shreddit/mod/removal-reason"> <faceplate-modal class="max-w-[540px] w-[90v w] z-30"> <div slot="closeButton"> ${e.r({appearance:"secondary",leadingIcon:t.C({size:t.I.Small}),size:e.s.Small,attributes:{type:"button",onclick:this.handleCancel}})} </div> <input type="hidden" name="thing" value="${this.thingId}"> ${o.aa(this.thingId,t.x` <faceplate-partial class="w-100" src="/svc/shreddit/removal-reason-form/${this.thingId}" loading="${e.I.Programmatic}"> <div class="w-100 h-4xl flex items-center justify-center"> <faceplate-progress value="20" class="animate-spin"></faceplate-progress> </div> </faceplate-partial> `)} <div slot="primaryButton"> ${e.r({children:t.x`<faceplate-progress value="20" class="animate-spin loading-icon hidden absolute left-0 right-0 m-auto w-[16px]" style="--loader-size:1rem"></faceplate-progress> <span class="submit-button-content"> Submit</span>`,appearance:"primary",attributes:{type:"submit",className:"w-100 relative"}})} </div> <div slot="secondaryButton"> ${e.r({children:"Cancel",appearance:"plain",attributes:{className:"w-100",type:"button",onclick:this.handleCancel}})} </div> </faceplate-modal> </removal-reason-form> `}};return j.styles=[e.t],e._([e.n({type:Boolean,attribute:"is-smart-escalations-community-rules-enabled"})],j.prototype,"isSmartEscalationsCommunityRulesEnabled",void 0),e._([e.n({type:Boolean,attribute:"is-expand-suggested-actions-enabled"})],j.prototype,"isExpandSuggestedActionsEnabled",void 0),e._([e.n({type:String})],j.prototype,"thingId",void 0),e._([e.n({type:String,attribute:"subreddit-name"})],j.prototype,"subredditName",void 0),e._([e.y("faceplate-modal")],j.prototype,"modal",void 0),e._([e.y("faceplate-partial")],j.prototype,"partial",void 0),j=e._([e.e("add-removal-reason-modal")],j),{A:H}}));